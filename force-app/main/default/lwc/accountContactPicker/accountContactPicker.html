<!--
  @description       : 
  @author            : Shahrukh Ahmed 
  @last modified on  : 19-03-2025
  @last modified by  : Shahrukh Ahmed 
-->
<template>
  <article class="slds-card">
    <div class="slds-card__header slds-grid">
      <header class="slds-media slds-media_center slds-has-flexi-truncate">
        <div class="slds-media__figure">
          <lightning-icon
            icon-name="standard:contact_list"
            alternative-text={title}
            title={title}
          ></lightning-icon>
        </div>
        <div class="slds-media__body">
          <h2 class="slds-card__header-title">
            <a
              href="#"
              class="slds-card__header-link slds-truncate"
              title={title}
            >
              <span>{title}</span>
            </a>
          </h2>
        </div>
      </header>
    </div>
    <div class="slds-card__body slds-card__body_inner">
      <div class="slds-grid slds-grid_vertical slds-box slds-theme_shade">
        <!-- Account Record Picker -->
        <div class="slds-col">
          <div class="slds-size_1-of-6">
            <lightning-record-picker
              label={label}
              placeholder="Search Accounts..."
              onchange={handleAccountChange}
              value={accountId}
              object-api-name={objectApiName}
            >
            </lightning-record-picker>
          </div>
        </div>
        <!-- Error Message -->
        <template if:true={error}>
          <hr />
          <div
            class="slds-notify slds-notify_alert slds-alert_error slds-m-top-medium"
            role="alert"
          >
            <span class="slds-assistive-text">error</span>
            <span
              class="slds-icon_container slds-icon-utility-error slds-m-right_x-small"
              title="Description of icon when needed"
            >
              <lightning-icon
                icon-name="utility:error"
                size="small"
                alternative-text="Error!"
                title="Error"
              ></lightning-icon>
            </span>
            <h2>{error}</h2>
          </div>
        </template>
        <!-- Related Contact Table -->
        <template if:true={isDataTable}>
          <hr />
          <div class="slds-col">
            <lightning-datatable
              key-field="Id"
              data={relatedContacts}
              columns={columns}
              onrowaction={handleRowAction}
              column-widths-mode="auto"
              hide-checkbox-column
              enable-infinite-loading
            ></lightning-datatable>
          </div>
        </template>
      </div>
    </div>
  </article>

  <!-- Modal for Contact Editing -->
  <template if:true={isModalOpen}>
    <c-edit-form-modal
      record-id={selectedContactId}
      object-api-name={relatedObject}
      onclose={handleModalClose}
    ></c-edit-form-modal>
  </template>
</template>
